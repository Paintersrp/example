import {
  __commonJS
} from "./chunk-J43GMYXM.js";

// node_modules/in-viewport/in-viewport.js
var require_in_viewport = __commonJS({
  "node_modules/in-viewport/in-viewport.js"(exports, module) {
    module.exports = inViewport;
    var instances = [];
    var supportsMutationObserver = typeof global.MutationObserver === "function";
    function inViewport(elt, params, cb) {
      var opts = {
        container: global.document.body,
        offset: 0,
        debounce: 15,
        failsafe: 150
      };
      if (params === void 0 || typeof params === "function") {
        cb = params;
        params = {};
      }
      var container = opts.container = params.container || opts.container;
      var offset = opts.offset = params.offset || opts.offset;
      var debounceValue = opts.debounce = params.debounce || opts.debounce;
      var failsafe = opts.failsafe = params.failsafe || opts.failsafe;
      if (failsafe === true) {
        failsafe = 150;
      } else if (failsafe === false) {
        failsafe = 0;
      }
      if (failsafe > 0 && failsafe < debounceValue) {
        failsafe = debounceValue + 50;
      }
      for (var i = 0; i < instances.length; i++) {
        if (instances[i].container === container && instances[i]._debounce === debounceValue && instances[i]._failsafe === failsafe) {
          return instances[i].isInViewport(elt, offset, cb);
        }
      }
      return instances[instances.push(createInViewport(container, debounceValue, failsafe)) - 1].isInViewport(elt, offset, cb);
    }
    function addEvent(el, type, fn) {
      if (el.attachEvent) {
        el.attachEvent("on" + type, fn);
      } else {
        el.addEventListener(type, fn, false);
      }
    }
    function debounce(func, wait, immediate) {
      var timeout;
      return function() {
        var context = this, args = arguments;
        var callNow = immediate && !timeout;
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
        if (callNow)
          func.apply(context, args);
        function later() {
          timeout = null;
          if (!immediate)
            func.apply(context, args);
        }
      };
    }
    var contains = function() {
      if (!global.document) {
        return true;
      }
      return global.document.documentElement.compareDocumentPosition ? function(a, b) {
        return !!(a.compareDocumentPosition(b) & 16);
      } : global.document.documentElement.contains ? function(a, b) {
        return a !== b && (a.contains ? a.contains(b) : false);
      } : function(a, b) {
        while (b = b.parentNode) {
          if (b === a) {
            return true;
          }
        }
        return false;
      };
    };
    function createInViewport(container, debounceValue, failsafe) {
      var watches = createWatches();
      var scrollContainer = container === global.document.body ? global : container;
      var debouncedCheck = debounce(watches.checkAll(watchInViewport), debounceValue);
      addEvent(scrollContainer, "scroll", debouncedCheck);
      if (scrollContainer === global) {
        addEvent(global, "resize", debouncedCheck);
      }
      if (supportsMutationObserver) {
        observeDOM(watches, container, debouncedCheck);
      }
      if (failsafe > 0) {
        setInterval(debouncedCheck, failsafe);
      }
      function isInViewport(elt, offset, cb) {
        if (!cb) {
          return isVisible(elt, offset);
        }
        var remote = createRemote(elt, offset, cb);
        remote.watch();
        return remote;
      }
      function createRemote(elt, offset, cb) {
        function watch() {
          watches.add(elt, offset, cb);
        }
        function dispose() {
          watches.remove(elt);
        }
        return {
          watch,
          dispose
        };
      }
      function watchInViewport(elt, offset, cb) {
        if (isVisible(elt, offset)) {
          watches.remove(elt);
          cb(elt);
        }
      }
      function isVisible(elt, offset) {
        if (!elt) {
          return false;
        }
        if (!contains(global.document.documentElement, elt) || !contains(global.document.documentElement, container)) {
          return false;
        }
        if (!elt.offsetWidth || !elt.offsetHeight) {
          return false;
        }
        var eltRect = elt.getBoundingClientRect();
        var viewport = {};
        if (container === global.document.body) {
          viewport = {
            top: -offset,
            left: -offset,
            right: global.document.documentElement.clientWidth + offset,
            bottom: global.document.documentElement.clientHeight + offset
          };
        } else {
          var containerRect = container.getBoundingClientRect();
          viewport = {
            top: containerRect.top - offset,
            left: containerRect.left - offset,
            right: containerRect.right + offset,
            bottom: containerRect.bottom + offset
          };
        }
        var visible = eltRect.right >= viewport.left && eltRect.left <= viewport.right && eltRect.bottom >= viewport.top && eltRect.top <= viewport.bottom;
        return visible;
      }
      return {
        container,
        isInViewport,
        _debounce: debounceValue,
        _failsafe: failsafe
      };
    }
    function createWatches() {
      var watches = [];
      function add(elt, offset, cb) {
        if (!isWatched(elt)) {
          watches.push([elt, offset, cb]);
        }
      }
      function remove(elt) {
        var pos = indexOf(elt);
        if (pos !== -1) {
          watches.splice(pos, 1);
        }
      }
      function indexOf(elt) {
        for (var i = watches.length - 1; i >= 0; i--) {
          if (watches[i][0] === elt) {
            return i;
          }
        }
        return -1;
      }
      function isWatched(elt) {
        return indexOf(elt) !== -1;
      }
      function checkAll(cb) {
        return function() {
          for (var i = watches.length - 1; i >= 0; i--) {
            cb.apply(this, watches[i]);
          }
        };
      }
      return {
        add,
        remove,
        isWatched,
        checkAll
      };
    }
    function observeDOM(watches, container, cb) {
      var observer = new MutationObserver(watch);
      var filter = Array.prototype.filter;
      var concat = Array.prototype.concat;
      observer.observe(container, {
        childList: true,
        subtree: true,
        attributes: true
      });
      function watch(mutations) {
        if (mutations.some(knownNodes) === true) {
          setTimeout(cb, 0);
        }
      }
      function knownNodes(mutation) {
        var nodes = concat.call(
          [],
          Array.prototype.slice.call(mutation.addedNodes),
          mutation.target
        );
        return filter.call(nodes, watches.isWatched).length > 0;
      }
    }
  }
});
export default require_in_viewport();
//# sourceMappingURL=in-viewport.js.map
